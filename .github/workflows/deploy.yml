name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ –≤–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    # --- –ù–ê–ß–ê–õ–û –ò–ó–ú–ï–ù–ï–ù–ò–ô ---
    # –≠—Ç–æ—Ç –±–ª–æ–∫ –¥–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç—É –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    permissions:
      contents: write
    # --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–ô ---

    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v3

      - name: List files in the repository
        run: ls -R

      - name: Replace API Key in HTML ü§´
        run: |
          # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞ –∑–¥–µ—Å—å –¢–û–ß–ù–û —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–∞—à–∏–º HTML-—Ñ–∞–π–ª–æ–º
          sed -i 's|%%GEMINI_API_KEY%%|${{ secrets.GEMINI_API_KEY }}|g' tool_rental_business_simulator_v6.html
        
      - name: Verify Key Replacement (DEBUG) ‚úÖ
        run: |
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∫–ª—é—á –≤—Å—Ç–∞–≤–ª–µ–Ω:"
          grep 'const apiKey =' tool_rental_business_simulator_v6.html | awk -F'"' '{print $1 "\"" substr($2, 1, 4) "..." substr($2, length($2)-3) "\""}'
      
      - name: Deploy üöÄ
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .

